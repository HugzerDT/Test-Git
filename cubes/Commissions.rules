SKIPCHECK;
# Pull data from the Sales_Plan cube
['Gross Sales Revenue'] = DB('Sales_Plan', !Subsidiaries, 'ALL CHANNELS', 'TOTAL PRODUCTS', 
							!Months, !Versions, 'GROSS SALES REVENUE');
# Calculate average Commission% at the consolidated level
['Commission_hold'] = N: ['Commission%'];
['Commission_count'] = N:IF(['Commission%'] <> 0, 1 , 0);
['Commission%'] = C:(['Commission_hold']\['Commission_count']);

# Calculate commission
['Commission'] = N:(['Gross Sales Revenue']*['Commission%'])/100;

FEEDERS;
['Commission%'] => ['Commission'], ['Commission_hold'], ['Commission_count'];
['Commission%'] => DB('Expenses', !Versions, !Months, !Subsidiaries,'Commission', 'Amount');